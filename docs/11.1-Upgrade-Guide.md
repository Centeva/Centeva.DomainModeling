# Upgrading to 11.0

## Breaking Changes

### .NET Supported Versions

The minimum supported .NET version is now .NET 8.0.

### Separate Packages for Domain Event Dispatching

There are now two separate implementations of domain event dispatching so that
you can choose between the commercially-licensed (for newer versions)
[MediatR](https://mediatr.io/) library and the open-source
[Mediator](https://github.com/martinothamar/Mediator) library.

* Centeva.DomainModeling.MediatR
* Centeva.DomainModeling.Mediator

You will need to:

* Update your application's package references to use the dispatcher you prefer.
* Update your Dependency Injection configuration.
* Update your code to reference the new namespace.

Here's an example of configuring to use the Mediator library:

```csharp
builder.Services
    .AddMediator()
    .AddSingleton<IDomainEventDispatcher, MediatorDomainEventDispatcher>();
```

### Removed DbContext Extensions

The previously obsoleted (10.2.0) DbContext.GetEntitiesWithEvents() extension
method has been removed.  Use the `DispatchDomainEventsInterceptor` as
desribed below.

## New Features

### EF Core Interceptor for Domain Event Dispatching (as of 10.2.0)

The `DispatchDomainEventsInterceptor` is an EF Core interceptor that dispatches
domain events after a successful save operation.  This allows you to keep your
domain events and their handlers separate from your application code, and
ensures that they are dispatched in a consistent manner.

To use the interceptor, add it to your DbContext options:

```csharp
builder.Services.AddSingleton<DispatchDomainEventsInterceptor>();
builder.Services.AddDbContext<ApplicationDbContext>((sp, options) =>
{
    options.AddInterceptors(sp.GetRequiredService<DispatchDomainEventsInterceptor>());
    options.UseSqlServer(connectionString);
    // ... other options
});
```
